# phaseLD
Developed by Alexandre Marand & Hanain Zhao, 2017

A simple LD based method to quickly phase pseudo-oneway test cross populations. Users should use a two step approach, first identifying the most probable haplotypes, via Bayesian methods (within phaseLD.pl), followed by HMM refinement of called haplotypes with HMM_snp.pl. 

Please cite "" if you use this software.  

## Dependencies
phaseLD.pl and HMM_snp.pl require users to have the following perl modules available to @INC:

1) [Sort::Naturally](http://search.cpan.org/~bingos/Sort-Naturally-1.03/lib/Sort/Naturally.pm)
2) [Getopt::Long](http://perldoc.perl.org/Getopt/Long.html)
3) [Pod::Usage](http://search.cpan.org/~marekr/Pod-Usage-1.69/lib/Pod/Usage.pm)
4) [List::Util](http://search.cpan.org/~pevans/Scalar-List-Utils-1.47/lib/List/Util.pm)
5) [Parallel::ForkManager](search.cpan.org/~yanick/Parallel-ForkMâ€¦)

All modules are available from CPAN, and can be accessed with cpan/cpanm.

Click [here] for link to cpanm.

[here]: http://search.cpan.org/~miyagawa/Menlo-1.9004/script/cpanm-menlo

## Usage
```
Usage:
    phaseLD.pl --in <foo.gen> [OPTIONS]

Options:
    --in|-i       Genotype file [String|REQUIRED]

    --out|-o      Prefix for output files [String|Default='phased']

    --win|-w      Set minimum window size for estimating LD [Int|Default=20]

    --step|-s     Set minimum step size for LD calculations in a sliding
                  window, defaults to 1 [Int|Default=1]

    --bwin|-n     Set minimum window size for bayes haplotype calling
                  [Int|Default=50]

    --bstep|-t    Set minimum step size for bayes haplotype calling
                  [Int|Default=5]

    --threads|-p  Set number of threads [Int|Default=1]

    --filter|-f   Optionally use file with suffix 'bad' generated by phaseLD
                  to filter poor markers. 'prefix.bad' contains IDs of bad
                  SNPs identified in the first pass. Useful to cleaning
                  haplotype switch problems [String|Optional]

    --help|-h     Print a brief help message and exit
```
